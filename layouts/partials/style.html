{{ $defaultPath := "sass/default.scss" }}
{{ $defaultResource := resources.Get $defaultPath }}

{{ if not $defaultResource }}
  {{ errorf "CRITICAL: SASS file not found in project assets: assets/%s. Please check your project's assets/sass directory." $defaultPath }}
{{ else }}
  {{/* Attempt to process default.scss only if found */}}
  {{ $options := (dict "targetPath" "css/default.css" "outputStyle" "compressed" "enableSourceMap" true) }}
  {{ $style := "" }}
  {{ with $defaultResource }} {{/* Ensure $defaultResource is not nil before piping */}}
    {{ $style = . | resources.ToCSS $options | resources.Fingerprint }}
  {{ end }}
  {{ if $style }}
    <link rel="stylesheet" href="{{ $style.Permalink }}" integrity="{{ $style.Data.Integrity }}" media="screen">
    {{ warnf "Successfully processed project default.scss" }}
  {{ else }}
    {{ errorf "CRITICAL: Failed to process SASS for default.scss, even though it was found. Check for SASS errors within the file or its imports." }}
  {{ end }}
{{ end }}

{{ if not .IsHome }}
  {{ $activityPath := "sass/activity.scss" }}
  {{ $activityResource := resources.Get $activityPath }}
  {{ if not $activityResource }}
    {{ errorf "CRITICAL: SASS file not found in project assets: assets/%s. Please check your project's assets/sass directory." $activityPath }}
  {{ else }}
    {{/* Attempt to process activity.scss only if found */}}
    {{ $options_activity := (dict "targetPath" "css/activity.css" "outputStyle" "compressed" "enableSourceMap" true) }}
    {{ $style_activity := "" }}
    {{ with $activityResource }} {{/* Ensure $activityResource is not nil before piping */}}
      {{ $style_activity = . | resources.ToCSS $options_activity | resources.Fingerprint }}
    {{ end }}
    {{ if $style_activity }}
      <link rel="stylesheet" href="{{ $style_activity.Permalink }}" integrity="{{ $style_activity.Data.Integrity }}" media="screen">
      {{ warnf "Successfully processed project activity.scss" }}
    {{ else }}
      {{ errorf "CRITICAL: Failed to process SASS for activity.scss, even though it was found. Check for SASS errors within the file or its imports (like default.scss)." }}
    {{ end }}
  {{ end }}
{{ end }}